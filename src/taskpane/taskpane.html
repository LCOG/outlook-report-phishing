<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT License. -->
<!-- This file shows how to design a first-run page that provides a welcome screen to the user about the features of the add-in. -->

<!doctype html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>LCOG Report Phish</title>

    <!-- Office JavaScript API -->
    <script
      type="text/javascript"
      src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"
    ></script>

    <!-- Template styles -->
    <link href="taskpane.css" rel="stylesheet" type="text/css" />
  </head>

  <body class="ms-welcome">
    <section id="sideload-msg" class="ms-welcome__main">
      <h2 class="ms-font-xl">
        Please
        <a
          rel="noreferrer noopener"
          target="_blank"
          href="https://learn.microsoft.com/office/dev/add-ins/testing/test-debug-office-add-ins#sideload-an-office-add-in-for-testing"
          >sideload</a
        >
        your add-in to see app body.
      </h2>
    </section>
    <main id="app-body" class="ms-welcome__main">
      <h2 class="ms-font-xl">LCOG Report Phish [Development Version]</h2>
      <fluent-divider></fluent-divider>
      <p class="ms-font-l">This email is:</p>
      <fluent-radio-group
        id="reportMessageTypeGroup"
        orientation="vertical"
        name="reportMessageType"
        value="phishing"
      >
        <fluent-radio value="phishing">Phishing</fluent-radio>
        <fluent-radio value="spam">Spam</fluent-radio>
        <fluent-radio value="other">Other</fluent-radio>
      </fluent-radio-group>
      <fluent-text-area
        id="additionalInfo"
        appearance="outline"
        placeholder="(Optional) Tell us more about this email"
      >
      </fluent-text-area>
      <fluent-button
        appearance="accent"
        id="reportPhishingEmail"
        aria-describedby="reportButtonTooltip"
      >
        Report email
      </fluent-button>
      <fluent-tooltip id="reportButtonTooltip" anchor="reportPhishingEmail" class="ms-font-s"
        >Report this email as a phishing or a spam message</fluent-tooltip
      >
      <div id="reportingProgress" class="reportingResult hidden" aria-live="polite" role="status">
        <fluent-progress-ring></fluent-progress-ring>
        <label>Reporting email...</label>
      </div>
      <div class="reportingResult hidden" id="reportingSuccess" aria-live="polite" role="status">
        <!-- Show a green checkmark when the email has been successfully reported -->
        <svg
          width="20"
          height="20"
          viewBox="0 0 20 20"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M10 0C4.48 0 0 4.48 0 10C0 15.52 4.48 20 10 20C15.52 20 20 15.52 20 10C20 4.48 15.52 0 10 0ZM8 15L3 10L4.41 8.59L8 12.17L15.59 4.58L17 6L8 15Z"
            fill="#28a745"
          />
        </svg>
        <label>Email has been reported to Service Desk.</label>
      </div>
      <div class="reportingResult hidden" id="reportingError" aria-live="assertive" role="alert">
        <!-- Show a red X when the email could not be reported -->
        <svg
          width="20"
          height="20"
          viewBox="0 0 20 20"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M10 0C4.48 0 0 4.48 0 10C0 15.52 4.48 20 10 20C15.52 20 20 15.52 20 10C20 4.48 15.52 0 10 0ZM11 15H9V13H11V15ZM11 11H9V5H11V11Z"
            fill="#dc3545"
          />
        </svg>
        <span>
          <label>Reporting the email failed:</label><br />
          <label id="reportingErrorMessage"></label>
        </span>
      </div>
      <fluent-button
        appearance="accent"
        id="moveToJunkButton"
        aria-describedby="moveToJunkTooltip"
        class="hidden"
      >
        Move email to junk and close pane
      </fluent-button>
      <fluent-tooltip id="moveToJunkTooltip" anchor="moveToJunkButton" class="ms-font-s"
        >Move the current email to the Junk Email folder and close the pane</fluent-tooltip
      >
    </main>
  </body>
</html>
